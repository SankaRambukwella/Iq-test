
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IQ Test Challenge</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 600px;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .header {
            position: relative;
            z-index: 10;
        }

        .title {
            font-size: 2.5em;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 20px;
        }

        .lang-switch {
            margin-bottom: 30px;
        }

        .lang-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            margin: 0 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .lang-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .lang-btn.active {
            background: linear-gradient(45deg, #764ba2, #667eea);
            transform: scale(1.05);
        }

        .screen {
            display: none;
            position: relative;
            z-index: 10;
        }

        .screen.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .start-btn, .next-btn, .restart-btn, .share-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            margin: 10px;
        }

        .start-btn:hover, .next-btn:hover, .restart-btn:hover, .share-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.3);
        }

        .question-container {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .question-number {
            font-size: 1.1em;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .question-text {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .option {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
            color: #333;
        }

        .option:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .option.selected {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .progress-bar {
            background: #e0e0e0;
            border-radius: 10px;
            height: 8px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(45deg, #667eea, #764ba2);
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .timer {
            font-size: 1.5em;
            color: #667eea;
            font-weight: bold;
            margin: 20px 0;
        }

        .result-score {
            font-size: 3em;
            color: #667eea;
            font-weight: bold;
            margin: 20px 0;
        }

        .iq-level {
            font-size: 1.5em;
            color: #764ba2;
            font-weight: bold;
            margin: 15px 0;
        }

        .leaderboard {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
        }

        .leaderboard-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .leaderboard-item:first-child {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
        }

        .leaderboard-item:nth-child(2) {
            background: linear-gradient(45deg, #c0c0c0, #e6e6e6);
        }

        .leaderboard-item:nth-child(3) {
            background: linear-gradient(45deg, #cd7f32, #daa520);
        }

        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .share-btn {
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 0.9em;
            min-width: 120px;
        }

        .share-btn.facebook {
            background: #3b5998;
        }

        .share-btn.twitter {
            background: #1da1f2;
        }

        .share-btn.whatsapp {
            background: #25d366;
        }

        .share-btn.linkedin {
            background: #0077b5;
        }

        .copyright {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8em;
            z-index: 1000;
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }

            .title {
                font-size: 2em;
            }

            .options {
                grid-template-columns: 1fr;
            }

            .share-buttons {
                flex-direction: column;
                align-items: center;
            }

            .share-btn {
                width: 100%;
                max-width: 200px;
            }

            .lang-btn {
                padding: 8px 16px;
                font-size: 0.9em;
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">IQ Test Challenge</h1>
            <p class="subtitle">Test Your Intelligence</p>
            
            <div class="lang-switch">
                <button class="lang-btn active" onclick="switchLanguage('en')">English</button>
                <button class="lang-btn" onclick="switchLanguage('si')">සිංහල</button>
            </div>
        </div>

        <!-- Home Screen -->
        <div class="screen active" id="home-screen">
            <div class="question-container">
                <h2 data-en="Welcome to the IQ Test!" data-si="IQ පරීක්ෂණයට සාදරයෙන් පිළිගනිමු!">Welcome to the IQ Test!</h2>
                <p data-en="Test your intelligence with 20 challenging questions. You'll have 30 seconds per question." data-si="ප්‍රශ්න 20කින් ඔබේ බුද්ධිමත්භාවය පරීක්ෂා කරන්න. එක් ප්‍රශ්නයකට තත්පර 30ක් ලැබේ.">Test your intelligence with 20 challenging questions. You'll have 30 seconds per question.</p>
            </div>
            <button class="start-btn" onclick="startTest()" data-en="Start Test" data-si="පරීක්ෂණය ආරම්භ කරන්න">Start Test</button>
        </div>

        <!-- Test Screen -->
        <div class="screen" id="test-screen">
            <div class="question-number" id="question-number">Question 1 of 20</div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="timer" id="timer">30</div>
            
            <div class="question-container">
                <div class="question-text" id="question-text"></div>
                <div class="options" id="options"></div>
            </div>
            
            <button class="next-btn" id="next-btn" onclick="nextQuestion()" data-en="Next Question" data-si="මීළඟ ප්‍රශ්නය">Next Question</button>
        </div>

        <!-- Results Screen -->
        <div class="screen" id="results-screen">
            <div class="question-container">
                <h2 data-en="Your Results" data-si="ඔබේ ප්‍රතිඵල">Your Results</h2>
                <div class="result-score" id="final-score">0</div>
                <div class="iq-level" id="iq-level"></div>
                <p id="result-description"></p>
            </div>
            
            <div class="share-buttons">
                <button class="share-btn facebook" onclick="shareResult('facebook')" data-en="Share on Facebook" data-si="Facebook හි බෙදාගන්න">Share on Facebook</button>
                <button class="share-btn twitter" onclick="shareResult('twitter')" data-en="Share on Twitter" data-si="Twitter හි බෙදාගන්න">Share on Twitter</button>
                <button class="share-btn whatsapp" onclick="shareResult('whatsapp')" data-en="Share on WhatsApp" data-si="WhatsApp හි බෙදාගන්න">Share on WhatsApp</button>
                <button class="share-btn linkedin" onclick="shareResult('linkedin')" data-en="Share on LinkedIn" data-si="LinkedIn හි බෙදාගන්න">Share on LinkedIn</button>
            </div>
            
            <button class="restart-btn" onclick="restartTest()" data-en="Take Test Again" data-si="නැවත පරීක්ෂණය කරන්න">Take Test Again</button>
        </div>

        <!-- Leaderboard Screen -->
        <div class="screen" id="leaderboard-screen">
            <h2 data-en="Top Scores" data-si="ඉහළම ලකුණු">Top Scores</h2>
            <div class="leaderboard" id="leaderboard"></div>
            <button class="restart-btn" onclick="showHome()" data-en="Back to Home" data-si="මුල් පිටුවට">Back to Home</button>
        </div>
    </div>

    <div class="copyright">
        © 2025 Developed by Sanka Rambukwella
    </div>

    <script>
        let currentLanguage = 'en';
        let currentQuestion = 0;
        let score = 0;
        let timeLeft = 30;
        let timer;
        let selectedAnswer = null;
        let startTime;

        // IQ Test Questions Database
        const questions = {
            en: [
                {
                    question: "What comes next in the sequence: 2, 4, 8, 16, ?",
                    options: ["24", "32", "20", "28"],
                    correct: 1
                },
                {
                    question: "If all roses are flowers and some flowers are red, which statement is true?",
                    options: ["All roses are red", "Some roses might be red", "No roses are red", "All flowers are roses"],
                    correct: 1
                },
                {
                    question: "What is the missing number: 1, 1, 2, 3, 5, 8, ?",
                    options: ["11", "13", "15", "10"],
                    correct: 1
                },
                {
                    question: "Which word doesn't belong: Cat, Dog, Bird, Fish, Table",
                    options: ["Cat", "Dog", "Bird", "Table"],
                    correct: 3
                },
                {
                    question: "If you rearrange the letters 'CIFAIPC', you get the name of a/an:",
                    options: ["Country", "Animal", "Ocean", "City"],
                    correct: 2
                },
                {
                    question: "What is 25% of 80?",
                    options: ["15", "20", "25", "30"],
                    correct: 1
                },
                {
                    question: "Complete the analogy: Book is to Reading as Fork is to:",
                    options: ["Eating", "Cooking", "Kitchen", "Spoon"],
                    correct: 0
                },
                {
                    question: "Which number should replace the question mark: 3, 6, 12, 24, ?",
                    options: ["36", "48", "42", "30"],
                    correct: 1
                },
                {
                    question: "If it takes 5 machines 5 minutes to make 5 widgets, how long would it take 100 machines to make 100 widgets?",
                    options: ["100 minutes", "20 minutes", "5 minutes", "1 minute"],
                    correct: 2
                },
                {
                    question: "What comes next: A, C, F, J, O, ?",
                    options: ["S", "T", "U", "V"],
                    correct: 2
                },
                {
                    question: "If you have 3 apples and you take away 2, how many do you have?",
                    options: ["1", "2", "3", "0"],
                    correct: 1
                },
                {
                    question: "What is the square root of 144?",
                    options: ["11", "12", "13", "14"],
                    correct: 1
                },
                {
                    question: "Complete the pattern: 1, 4, 9, 16, 25, ?",
                    options: ["30", "35", "36", "49"],
                    correct: 2
                },
                {
                    question: "Which shape has the most sides: Triangle, Square, Pentagon, Hexagon?",
                    options: ["Triangle", "Square", "Pentagon", "Hexagon"],
                    correct: 3
                },
                {
                    question: "If today is Monday, what day will it be in 100 days?",
                    options: ["Monday", "Tuesday", "Wednesday", "Thursday"],
                    correct: 1
                },
                {
                    question: "What is 7 × 8 × 0 × 5?",
                    options: ["280", "0", "35", "40"],
                    correct: 1
                },
                {
                    question: "Which number is different: 2, 4, 6, 8, 9, 10?",
                    options: ["2", "4", "9", "10"],
                    correct: 2
                },
                {
                    question: "Complete: Water is to Ice as Milk is to:",
                    options: ["Cream", "Butter", "Cheese", "Yogurt"],
                    correct: 2
                },
                {
                    question: "What is the next prime number after 17?",
                    options: ["18", "19", "20", "21"],
                    correct: 1
                },
                {
                    question: "If a clock shows 3:15, what is the angle between the hour and minute hands?",
                    options: ["0°", "7.5°", "15°", "22.5°"],
                    correct: 1
                }
            ],
            si: [
                {
                    question: "අනුක්‍රමයේ මීළඟ සංඛ්‍යාව කුමක්ද: 2, 4, 8, 16, ?",
                    options: ["24", "32", "20", "28"],
                    correct: 1
                },
                {
                    question: "සියලු රෝස මල් වන අතර සමහර මල් රතු නම්, සත්‍ය ප්‍රකාශනය කුමක්ද?",
                    options: ["සියලු රෝස රතු ය", "සමහර රෝස රතු විය හැක", "කිසිදු රෝසයක් රතු නැත", "සියලු මල් රෝස ය"],
                    correct: 1
                },
                {
                    question: "අස්ථානගත සංඛ්‍යාව කුමක්ද: 1, 1, 2, 3, 5, 8, ?",
                    options: ["11", "13", "15", "10"],
                    correct: 1
                },
                {
                    question: "කුමන වචනය අනෙක් ඒවාට අයත් නොවේද: බළලා, බල්ලා, කුරුල්ලා, මාළුවා, මේසය",
                    options: ["බළලා", "බල්ලා", "කුරුල්ලා", "මේසය"],
                    correct: 3
                },
                {
                    question: "'CIFAIPC' අකුරු නැවත සකසන්නේ නම් ලැබෙන්නේ:",
                    options: ["රටක නම", "සතෙකුගේ නම", "සාගරයක නම", "නගරයක නම"],
                    correct: 2
                },
                {
                    question: "80 හි 25% කීයද?",
                    options: ["15", "20", "25", "30"],
                    correct: 1
                },
                {
                    question: "සාදෘශ්‍යය සම්පූර්ණ කරන්න: පොත කියවීමට යම් සේ දෙබලක කුමකට ද:",
                    options: ["කෑමට", "උයන්න", "කුස්සියට", "හැන්දකට"],
                    correct: 0
                },
                {
                    question: "ප්‍රශ්න ලකුණ වෙනුවට එන සංඛ්‍යාව: 3, 6, 12, 24, ?",
                    options: ["36", "48", "42", "30"],
                    correct: 1
                },
                {
                    question: "යන්ත්‍ර 5ක් විනාඩි 5කින් කෑලි 5ක් හැදුවහොත්, යන්ත්‍ර 100ක් කෑලි 100ක් හැදීමට කාලය?",
                    options: ["විනාඩි 100", "විනාඩි 20", "විනාඩි 5", "විනාඩි 1"],
                    correct: 2
                },
                {
                    question: "මීළඟ අකුර: A, C, F, J, O, ?",
                    options: ["S", "T", "U", "V"],
                    correct: 2
                },
                {
                    question: "ඔබ අසුරන්නතේ 3ක් තිබී 2ක් ගත්තහොත්, ඔබ සතුව කීයක් තිබේද?",
                    options: ["1", "2", "3", "0"],
                    correct: 1
                },
                {
                    question: "144 හි වර්ග මූලය කුමක්ද?",
                    options: ["11", "12", "13", "14"],
                    correct: 1
                },
                {
                    question: "රටාව සම්පූර්ණ කරන්න: 1, 4, 9, 16, 25, ?",
                    options: ["30", "35", "36", "49"],
                    correct: 2
                },
                {
                    question: "වැඩිම පැති ප්‍රමාණය ඇති හැඩය: ත්‍රිකෝණය, චතුරස්‍රය, පංචකෝණය, ෂඩ්කෝණය?",
                    options: ["ත්‍රිකෝණය", "චතුරස්‍රය", "පංචකෝණය", "ෂඩ්කෝණය"],
                    correct: 3
                },
                {
                    question: "අද සඳුදා නම්, දින 100කින් කුමන දිනයක් වේද?",
                    options: ["සඳුදා", "අඟහරුවාදා", "බදාදා", "බ්‍රහස්පතින්දා"],
                    correct: 1
                },
                {
                    question: "7 × 8 × 0 × 5 = ?",
                    options: ["280", "0", "35", "40"],
                    correct: 1
                },
                {
                    question: "වෙනස් සංඛ්‍යාව: 2, 4, 6, 8, 9, 10?",
                    options: ["2", "4", "9", "10"],
                    correct: 2
                },
                {
                    question: "සම්පූර්ණ කරන්න: වතුර අයිස්වලට යම් සේ කිරි කුමකට ද:",
                    options: ["ක්‍රීම්", "බටර්", "චීස්", "දමුරු"],
                    correct: 2
                },
                {
                    question: "17 ට පසු මීළඟ ප්‍රාථමික සංඛ්‍යාව?",
                    options: ["18", "19", "20", "21"],
                    correct: 1
                },
                {
                    question: "ඔරලෝසුවක 3:15 පෙන්වන්නේ නම්, කාල සහ මිනිත්තු ඉඳිකටුවේ කෝණය?",
                    options: ["0°", "7.5°", "15°", "22.5°"],
                    correct: 1
                }
            ]
        };

        // Initialize the app
        function init() {
            updateLanguage();
            loadLeaderboard();
        }

        // Language switching
        function switchLanguage(lang) {
            currentLanguage = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            updateLanguage();
        }

        function updateLanguage() {
            document.querySelectorAll('[data-en]').forEach(element => {
                element.textContent = element.getAttribute('data-' + currentLanguage);
            });
        }

        // Test functionality
        function startTest() {
            currentQuestion = 0;
            score = 0;
            startTime = Date.now();
            showScreen('test-screen');
            loadQuestion();
        }

        function loadQuestion() {
            if (currentQuestion >= questions[currentLanguage].length) {
                endTest();
                return;
            }

            const question = questions[currentLanguage][currentQuestion];
            
            // Update question display
            document.getElementById('question-number').textContent = 
                currentLanguage === 'en' ? 
                `Question ${currentQuestion + 1} of ${questions[currentLanguage].length}` :
                `ප්‍රශ්නය ${currentQuestion + 1}/${questions[currentLanguage].length}`;
            
            document.getElementById('question-text').textContent = question.question;
            
            // Update progress bar
            const progress = ((currentQuestion + 1) / questions[currentLanguage].length) * 100;
            document.getElementById('progress-fill').style.width = progress + '%';
            
            // Load options
            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectAnswer(index, optionDiv);
                optionsContainer.appendChild(optionDiv);
            });
            
            // Reset timer
            timeLeft = 30;
            startTimer();
            
            // Reset next button
            selectedAnswer = null;
            document.getElementById('next-btn').classList.add('disabled');
        }

        function selectAnswer(index, element) {
            // Remove previous selections
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            
            // Select current option
            element.classList.add('selected');
            selectedAnswer = index;
            
            // Enable next button
            document.getElementById('next-btn').classList.remove('disabled');
        }

        function startTimer() {
            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    nextQuestion();
                }
            }, 1000);
        }

        function nextQuestion() {
            if (selectedAnswer !== null) {
                const question = questions[currentLanguage][currentQuestion];
                if (selectedAnswer === question.correct) {
                    score++;
                }
            }
            
            currentQuestion++;
            clearInterval(timer);
            
            if (currentQuestion >= questions[currentLanguage].length) {
                endTest();
            } else {
                loadQuestion();
            }
        }

        function endTest() {
            clearInterval(timer);
            
            // Calculate IQ score
            const totalTime = Math.round((Date.now() - startTime) / 1000);
            const accuracy = (score / questions[currentLanguage].length) * 100;
            const timeBonus = Math.max(0, (600 - totalTime) / 10); // Bonus for speed
            const iqScore = Math.round(85 + (accuracy * 0.3) + timeBonus);
            
            // Display results
            document.getElementById('final-score').textContent = iqScore;
            
            // Determine IQ level
            let level, description;
            if (iqScore >= 140) {
                level = currentLanguage === 'en' ? 'Genius' : 'ප්‍රතිභාවන්ත';
                description = currentLanguage === 'en' ? 
                    'Exceptional intelligence! You\'re in the top 1% of the population.' :
                    'සුවිශේෂී බුද්ධිමත්භාවයක්! ඔබ ජනගහනයෙන් 1% ට අයත් වේ.';
            } else if (iqScore >= 120) {
                level = currentLanguage === 'en' ? 'Superior' : 'උසස්';
                description = currentLanguage === 'en' ? 
                    'Above average intelligence. Great problem-solving abilities!' :
                    'සාමාන්‍යයට වඩා ඉහළ බුද්ධිමත්භාවයක්. විශිෂ්ට ගැටලු විසඳීමේ හැකියාවක්!';
            } else if (iqScore >= 110) {
                level = currentLanguage === 'en' ? 'High Average' : 'ඉහළ සාමාන්‍ය';
                description = currentLanguage === 'en' ? 
                    'Good intelligence level. Well above average performance.' :
                    'හොඳ බුද්ධිමත්භාවයක්. සාමාන්‍යයට වඩා හොඳ කාර්ය සාධනයක්.';
            } else if (iqScore >= 90) {
                level = currentLanguage === 'en' ? 'Average' : 'සාමාන්‍ය';
                description = currentLanguage === 'en' ? 
                    'Average intelligence. Good logical thinking skills.' :
                    'සාමාන්‍ය බුද්ධිමත්භාවයක්. හොඳ තාර්කික චින්තන හැකියාවක්.';
            } else {
                level = currentLanguage === 'en' ? 'Below Average' : 'සාමාන්‍යයට වඩා අඩු';
                description = currentLanguage === 'en' ? 
                    'Room for improvement. Keep practicing to enhance your skills!' :
                    'දියුණුවීමට ඉඩ ඇත. ඔබේ හැකියාවන් වැඩිදියුණු කිරීමට අඛණ්ඩව අභ්‍යාස කරන්න!';
            }
            
            document.getElementById('iq-level').textContent = level;
            document.getElementById('result-description').textContent = description;
            
            // Save to leaderboard
            saveScore(iqScore);
            
            showScreen('results-screen');
        }

        function saveScore(iqScore) {
            const playerName = prompt(
                currentLanguage === 'en' ? 
                'Enter your name for the leaderboard:' : 
                'ලීඩර්බෝර්ඩ් සඳහා ඔබේ නම ඇතුළත් කරන්න:'
            ) || (currentLanguage === 'en' ? 'Anonymous' : 'නිර්නාමික');
            
            const scoreData = {
                name: playerName,
                score: iqScore,
                date: new Date().toLocaleDateString(),
                timestamp: Date.now(),
                language: currentLanguage
            };
            
            // Show loading indicator
            showLoadingMessage();
            
            // Send to Google Sheets
            sendToGoogleSheets(scoreData);
        }

        function sendToGoogleSheets(scoreData) {
            // Google Apps Script Web App URL - Replace with your actual URL
            const scriptURL = 'https://script.google.com/macros/s/AKfycbzPWwC4TQQIjVhVk31sRiDoPNDXkjn8CvffgJcMJU8KRQ1zPgoWIbKiFPsPZbKicteyFA/exec';
            
            fetch(scriptURL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(scoreData)
            })
            .then(() => {
                console.log('Score saved to Google Sheets successfully');
                hideLoadingMessage();
                loadLeaderboard(); // Refresh leaderboard
                showSuccessMessage();
            })
            .catch(error => {
                console.error('Error saving to Google Sheets:', error);
                hideLoadingMessage();
                showErrorMessage();
            });
        }

        function loadLeaderboard() {
            const leaderboardContainer = document.getElementById('leaderboard');
            
            // Show loading indicator
            leaderboardContainer.innerHTML = `
                <div class="leaderboard-item">
                    <span class="loading"></span>
                    <span>${currentLanguage === 'en' ? 'Loading scores...' : 'ලකුණු පූරණය වේ...'}</span>
                </div>
            `;
            
            // Google Apps Script Web App URL for reading data
            const scriptURL = 'https://script.google.com/macros/s/AKfycbzPWwC4TQQIjVhVk31sRiDoPNDXkjn8CvffgJcMJU8KRQ1zPgoWIbKiFPsPZbKicteyFA/exec';
            
            fetch(scriptURL + '?action=getLeaderboard', {
                method: 'GET',
                mode: 'no-cors'
            })
            .then(response => response.json())
            .then(data => {
                displayLeaderboard(data.scores || []);
            })
            .catch(error => {
                console.error('Error loading leaderboard:', error);
                // Fallback to show empty leaderboard
                displayLeaderboard([]);
            });
        }

        function displayLeaderboard(scores) {
            const leaderboardContainer = document.getElementById('leaderboard');
            
            if (scores.length === 0) {
                leaderboardContainer.innerHTML = `
                    <div class="leaderboard-item">
                        <span>${currentLanguage === 'en' ? 'No scores yet. Be the first!' : 'තවම ලකුණු නැත. පළමුවන්නා වන්න!'}</span>
                    </div>
                `;
                return;
            }
            
            // Sort scores by IQ score (highest first)
            scores.sort((a, b) => b.score - a.score);
            
            leaderboardContainer.innerHTML = scores.slice(0, 10).map((entry, index) => `
                <div class="leaderboard-item">
                    <span>${index + 1}. ${entry.name}</span>
                    <span>${entry.score} IQ</span>
                    <span>${entry.date}</span>
                </div>
            `).join('');
        }

        function showLoadingMessage() {
            const loadingDiv = document.createElement('div');
            loadingDiv.id = 'loading-message';
            loadingDiv.innerHTML = `
                <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                            background: rgba(0,0,0,0.8); color: white; padding: 20px; border-radius: 10px; z-index: 9999;">
                    <div class="loading" style="margin-right: 10px;"></div>
                    <span>${currentLanguage === 'en' ? 'Saving your score...' : 'ඔබේ ලකුණු සුරකිමින්...'}</span>
                </div>
            `;
            document.body.appendChild(loadingDiv);
        }

        function hideLoadingMessage() {
            const loadingDiv = document.getElementById('loading-message');
            if (loadingDiv) {
                loadingDiv.remove();
            }
        }

        function showSuccessMessage() {
            const successDiv = document.createElement('div');
            successDiv.innerHTML = `
                <div style="position: fixed; top: 20px; right: 20px; 
                            background: linear-gradient(45deg, #4CAF50, #45a049); color: white; 
                            padding: 15px 20px; border-radius: 10px; z-index: 9999; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                    <span>${currentLanguage === 'en' ? '✓ Score saved successfully!' : '✓ ලකුණු සාර්ථකව සුරකින ලදී!'}</span>
                </div>
            `;
            document.body.appendChild(successDiv);
            setTimeout(() => successDiv.remove(), 3000);
        }

        function showErrorMessage() {
            const errorDiv = document.createElement('div');
            errorDiv.innerHTML = `
                <div style="position: fixed; top: 20px; right: 20px; 
                            background: linear-gradient(45deg, #f44336, #d32f2f); color: white; 
                            padding: 15px 20px; border-radius: 10px; z-index: 9999; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                    <span>${currentLanguage === 'en' ? '⚠ Error saving score. Please try again.' : '⚠ ලකුණු සුරකීමේ දෝෂයකි. නැවත උත්සාහ කරන්න.'}</span>
                </div>
            `;
            document.body.appendChild(errorDiv);
            setTimeout(() => errorDiv.remove(), 5000);
        }

        function shareResult(platform) {
            const score = document.getElementById('final-score').textContent;
            const level = document.getElementById('iq-level').textContent;
            
            const shareText = currentLanguage === 'en' ? 
                `I just scored ${score} IQ on this amazing IQ test! My level is ${level}. Try it yourself!` :
                `මම මෙම විශිෂ්ට IQ පරීක්ෂණයෙන් ${score} IQ ලකුණු ලබා ගත්තා! මගේ මට්ටම ${level}. ඔබත් උත්සාහ කරන්න!`;
            
            const url = window.location.href;
            
            let shareURL = '';
            
            switch (platform) {
                case 'facebook':
                    shareURL = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}&quote=${encodeURIComponent(shareText)}`;
                    break;
                case 'twitter':
                    shareURL = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(url)}`;
                    break;
                case 'whatsapp':
                    shareURL = `https://wa.me/?text=${encodeURIComponent(shareText + ' ' + url)}`;
                    break;
                case 'linkedin':
                    shareURL = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`;
                    break;
            }
            
            window.open(shareURL, '_blank', 'width=600,height=400');
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
            
            if (screenId === 'leaderboard-screen') {
                loadLeaderboard();
            }
        }

        function showHome() {
            showScreen('home-screen');
        }

        function restartTest() {
            showScreen('home-screen');
        }

        function showLeaderboard() {
            showScreen('leaderboard-screen');
        }

        // Initialize app when page loads
        window.onload = init;

        // Prevent cheating by detecting developer tools
        let devtools = {
            open: false,
            orientation: null
        };

        const threshold = 160;

        setInterval(() => {
            if (window.outerHeight - window.innerHeight > threshold || 
                window.outerWidth - window.innerWidth > threshold) {
                if (!devtools.open) {
                    devtools.open = true;
                    alert(currentLanguage === 'en' ? 
                        'Developer tools detected! Please close them to continue.' :
                        'සංවර්ධක මෙවලම් අනාවරණය විය! ඉදිරියට යාමට ඒවා වසන්න.');
                }
            } else {
                devtools.open = false;
            }
        }, 500);

        // Disable right-click context menu
        document.addEventListener('contextmenu', e => e.preventDefault());

        // Disable common keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F12' || 
                (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                (e.ctrlKey && e.shiftKey && e.key === 'C') ||
                (e.ctrlKey && e.shiftKey && e.key === 'J') ||
                (e.ctrlKey && e.key === 'U')) {
                e.preventDefault();
                return false;
            }
        });

        // Add visual feedback for interactions
        document.addEventListener('DOMContentLoaded', function() {
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    this.classList.add('pulse');
                    setTimeout(() => this.classList.remove('pulse'), 200);
                });
            });
        });

        // Add leaderboard button to home screen
        document.getElementById('home-screen').innerHTML += `
            <button class="start-btn" onclick="showLeaderboard()" data-en="View Leaderboard" data-si="ලකුණු පුවරුව බලන්න" style="margin-top: 10px;">View Leaderboard</button>
        `;

        // Mobile-specific optimizations
        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
            document.body.classList.add('mobile');
            
            // Prevent zoom on input focus
            document.addEventListener('touchstart', function() {}, true);
            
            // Add touch feedback
            document.addEventListener('touchstart', function(e) {
                e.target.classList.add('touch-active');
            });
            
            document.addEventListener('touchend', function(e) {
                e.target.classList.remove('touch-active');
            });
        }
    </script>

    <style>
        .touch-active {
            transform: scale(0.95);
            transition: transform 0.1s ease;
        }

        .mobile .container {
            padding: 15px;
            border-radius: 15px;
        }

        .mobile .title {
            font-size: 1.8em;
        }

        .mobile .question-container {
            padding: 20px;
        }

        .mobile .option {
            padding: 12px;
            font-size: 0.9em;
        }

        .mobile .timer {
            font-size: 1.2em;
        }

        .mobile .result-score {
            font-size: 2.5em;
        }

        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive adjustments */
        @media (max-width: 480px) {
            .container {
                margin: 5px;
                padding: 15px;
            }
            
            .title {
                font-size: 1.5em;
            }
            
            .question-text {
                font-size: 1.1em;
            }
            
            .option {
                padding: 10px;
            }
            
            .start-btn, .next-btn, .restart-btn {
                padding: 12px 25px;
                font-size: 1em;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            }
            
            .container {
                background: rgba(44, 62, 80, 0.95);
                color: white;
            }
            
            .question-container {
                background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
                color: white;
            }
            
            .option {
                background: rgba(255, 255, 255, 0.1);
                color: white;
                border-color: rgba(255, 255, 255, 0.2);
            }
            
            .leaderboard {
                background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            }
            
            .leaderboard-item {
                background: rgba(255, 255, 255, 0.1);
                color: white;
            }
        }
    </style>
</body>
</html>
